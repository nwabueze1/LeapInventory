{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\USER\\\\Desktop\\\\typescript\\\\my-app\\\\pages\\\\customers.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect, useContext } from 'react';\nimport { Button, Card, Container, Table } from 'react-bootstrap';\nimport useFirebase from '../components/useFirebase';\nimport { useRouter } from 'next/router';\nimport { toast, ToastContainer } from 'react-toastify';\nimport AuthGuard from '../components/Authentification';\nimport Pagination from '../components/common/pagination';\nexport default function Customers() {\n  _s();\n\n  var _this = this;\n\n  var _useState = useState([]),\n      customers = _useState[0],\n      setCustomers = _useState[1];\n\n  var _useState2 = useState(4),\n      pageSize = _useState2[0],\n      setPageSize = _useState2[1];\n\n  var _useState3 = useState(1),\n      currentPage = _useState3[0],\n      setCurrentpage = _useState3[1];\n\n  var router = useRouter();\n  var app = useContext(useFirebase);\n  var firestore = app.firestore();\n\n  var handleDelete = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(id) {\n      var deleteConfirm, allCustomers, filtered;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              deleteConfirm = confirm('Are you sure you ant to delete this document?');\n\n              if (!deleteConfirm) {\n                _context.next = 16;\n                break;\n              }\n\n              //update the state\n              allCustomers = customers;\n              filtered = allCustomers.filter(function (m) {\n                return m._id !== id;\n              });\n              setCustomers(filtered);\n              _context.prev = 5;\n              _context.next = 8;\n              return firestore.collection('customers').doc(id)[\"delete\"]();\n\n            case 8:\n              _context.next = 14;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](5);\n              toast.error('cant perform this operation');\n              setCustomers(allCustomers);\n\n            case 14:\n              //call the database to delete the customer with the id\n              toast.success('deleted successfully');\n              console.log(id);\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[5, 10]]);\n    }));\n\n    return function handleDelete(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleEdit = function handleEdit(id) {\n    // router.push(`customersForm/${id}`);\n    //find the customer with the give id and edit\n    console.log(id);\n  };\n\n  var handlePageChange = function handlePageChange(page) {\n    console.log(page);\n  };\n\n  useEffect(function () {\n    function getCustomers() {\n      return _getCustomers.apply(this, arguments);\n    }\n\n    function _getCustomers() {\n      _getCustomers = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var citiesRef, snapshot, customers;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                citiesRef = firestore.collection('customers');\n                _context2.next = 3;\n                return citiesRef.get();\n\n              case 3:\n                snapshot = _context2.sent;\n                customers = [];\n                snapshot.forEach(function (doc) {\n                  var currentId = doc.id;\n\n                  var appObj = _objectSpread(_objectSpread({}, doc.data()), {}, _defineProperty({}, '_id', currentId));\n\n                  customers.push(appObj);\n                  console.log(customers);\n                });\n                setCustomers(customers);\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n      return _getCustomers.apply(this, arguments);\n    }\n\n    getCustomers();\n  }, []);\n  return __jsx(AuthGuard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 3\n    }\n  }, __jsx(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 4\n    }\n  }, __jsx(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 5\n    }\n  }, __jsx(Card.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 6\n    }\n  }, \"Customers\", __jsx(\"span\", {\n    className: \"float-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }\n  }, __jsx(Button, {\n    onClick: function onClick() {\n      return router.push('/customersForm');\n    },\n    className: \"btn-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 8\n    }\n  }, \"Add\"))), __jsx(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 6\n    }\n  }, __jsx(Table, {\n    striped: true,\n    bordered: true,\n    hover: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }\n  }, __jsx(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 8\n    }\n  }, __jsx(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 10\n    }\n  }, \"S/N\"), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 10\n    }\n  }, __jsx(\"span\", {\n    className: \"material-icons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 11\n    }\n  }, \"person\")), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 10\n    }\n  }, __jsx(\"span\", {\n    className: \"material-icons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 11\n    }\n  }, \"mail\")), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 10\n    }\n  }, __jsx(\"span\", {\n    className: \"material-icons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, \"address\")), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 10\n    }\n  }, __jsx(\"span\", {\n    className: \"material-icons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }\n  }, \"contact_phone\")), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 10\n    }\n  }, __jsx(\"span\", {\n    className: \"material-icons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 11\n    }\n  }, \"add\")), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 10\n    }\n  }, __jsx(\"span\", {\n    className: \"material-icons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 11\n    }\n  }, \"delete\")))), __jsx(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 8\n    }\n  }, customers.map(function (customer, index) {\n    return __jsx(\"tr\", {\n      key: customer.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 10\n      }\n    }, __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }\n    }, index + 1), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }\n    }, customer.name), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }\n    }, customer.email), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }\n    }, customer.address), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }\n    }, customer.phone), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }\n    }, __jsx(Button, {\n      onClick: function onClick() {\n        return handleEdit(customer._id);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 12\n      }\n    }, \"Edit\")), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 11\n      }\n    }, __jsx(Button, {\n      onClick: function onClick() {\n        return handleDelete(customer._id);\n      },\n      className: \"btn-danger\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 12\n      }\n    }, \"Delete\")));\n  }))), __jsx(Pagination, {\n    itemsCount: customers.length,\n    currentPage: currentPage,\n    pageSize: pageSize,\n    onPageChange: handlePageChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  })), __jsx(ToastContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 6\n    }\n  }))));\n}\n\n_s(Customers, \"PRXX1T2Ry9K9VAs0O7eyotazY7w=\", false, function () {\n  return [useRouter];\n});\n\n_c = Customers;\n\nvar _c;\n\n$RefreshReg$(_c, \"Customers\");","map":{"version":3,"sources":["C:/Users/USER/Desktop/typescript/my-app/pages/customers.tsx"],"names":["React","useState","useEffect","useContext","Button","Card","Container","Table","useFirebase","useRouter","toast","ToastContainer","AuthGuard","Pagination","Customers","customers","setCustomers","pageSize","setPageSize","currentPage","setCurrentpage","router","app","firestore","handleDelete","id","deleteConfirm","confirm","allCustomers","filtered","filter","m","_id","collection","doc","error","success","console","log","handleEdit","handlePageChange","page","getCustomers","citiesRef","get","snapshot","forEach","currentId","appObj","data","push","map","customer","index","name","email","address","phone","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport { Accordion, Button, Card, Container, FormControl, InputGroup, Spinner, Table } from 'react-bootstrap';\r\nimport useFirebase from '../components/useFirebase';\r\nimport { useRouter } from 'next/router';\r\nimport { toast, ToastContainer } from 'react-toastify';\r\nimport AuthGuard from '../components/Authentification';\r\nimport Pagination from '../components/common/pagination';\r\n\r\nexport interface Customers {\r\n\tid: string;\r\n\tname: string;\r\n\temail: string;\r\n\taddress: string;\r\n\tphone: string;\r\n\ttype: 'Roaster' | 'One-off';\r\n\t_id?: any;\r\n}\r\n\r\nexport default function Customers(): JSX.Element {\r\n\tconst [customers, setCustomers] = useState<Array<Customers>>([]);\r\n\tconst [pageSize, setPageSize] = useState(4);\r\n\tconst [currentPage, setCurrentpage] = useState(1);\r\n\tconst router = useRouter();\r\n\tconst app = useContext(useFirebase);\r\n\tconst firestore = app.firestore();\r\n\r\n\tconst handleDelete = async (id: string) => {\r\n\t\tconst deleteConfirm = confirm('Are you sure you ant to delete this document?');\r\n\t\tif (deleteConfirm) {\r\n\t\t\t//update the state\r\n\t\t\tconst allCustomers = customers;\r\n\t\t\tconst filtered = allCustomers.filter((m) => m._id !== id);\r\n\t\t\tsetCustomers(filtered);\r\n\t\t\ttry {\r\n\t\t\t\tawait firestore.collection('customers').doc(id).delete();\r\n\t\t\t} catch (error) {\r\n\t\t\t\ttoast.error('cant perform this operation');\r\n\t\t\t\tsetCustomers(allCustomers);\r\n\t\t\t}\r\n\r\n\t\t\t//call the database to delete the customer with the id\r\n\r\n\t\t\ttoast.success('deleted successfully');\r\n\t\t\tconsole.log(id);\r\n\t\t}\r\n\t};\r\n\tconst handleEdit = (id: string) => {\r\n\t\t// router.push(`customersForm/${id}`);\r\n\t\t//find the customer with the give id and edit\r\n\t\tconsole.log(id);\r\n\t};\r\n\tconst handlePageChange = (page: number) => {\r\n\t\tconsole.log(page);\r\n\t};\r\n\tuseEffect(() => {\r\n\t\tasync function getCustomers() {\r\n\t\t\tconst citiesRef = firestore.collection('customers');\r\n\t\t\tconst snapshot = await citiesRef.get();\r\n\r\n\t\t\tconst customers: Array<Customers> = [];\r\n\r\n\t\t\tsnapshot.forEach((doc) => {\r\n\t\t\t\tlet currentId = doc.id;\r\n\t\t\t\tlet appObj = { ...doc.data(), ['_id']: currentId };\r\n\t\t\t\tcustomers.push(appObj as Customers);\r\n\t\t\t\tconsole.log(customers);\r\n\t\t\t});\r\n\r\n\t\t\tsetCustomers(customers);\r\n\t\t}\r\n\t\tgetCustomers();\r\n\t}, []);\r\n\treturn (\r\n\t\t<AuthGuard>\r\n\t\t\t<Container>\r\n\t\t\t\t<Card>\r\n\t\t\t\t\t<Card.Header>\r\n\t\t\t\t\t\tCustomers\r\n\t\t\t\t\t\t<span className=\"float-right\">\r\n\t\t\t\t\t\t\t<Button onClick={() => router.push('/customersForm')} className=\"btn-info\">\r\n\t\t\t\t\t\t\t\tAdd\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</Card.Header>\r\n\r\n\t\t\t\t\t<Card.Body>\r\n\t\t\t\t\t\t<Table striped bordered hover>\r\n\t\t\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<th>S/N</th>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"material-icons\">person</span>\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"material-icons\">mail</span>\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"material-icons\">address</span>\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"material-icons\">contact_phone</span>\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"material-icons\">add</span>\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"material-icons\">delete</span>\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t{customers.map((customer, index) => (\r\n\t\t\t\t\t\t\t\t\t<tr key={customer.id}>\r\n\t\t\t\t\t\t\t\t\t\t<td>{index + 1}</td>\r\n\t\t\t\t\t\t\t\t\t\t<td>{customer.name}</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<td>{customer.email}</td>\r\n\t\t\t\t\t\t\t\t\t\t<td>{customer.address}</td>\r\n\t\t\t\t\t\t\t\t\t\t<td>{customer.phone}</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Button onClick={() => handleEdit(customer._id)}>Edit</Button>\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Button onClick={() => handleDelete(customer._id)} className=\"btn-danger\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tDelete\r\n\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t</Table>\r\n\t\t\t\t\t\t<Pagination\r\n\t\t\t\t\t\t\titemsCount={customers.length}\r\n\t\t\t\t\t\t\tcurrentPage={currentPage}\r\n\t\t\t\t\t\t\tpageSize={pageSize}\r\n\t\t\t\t\t\t\tonPageChange={handlePageChange}\r\n\t\t\t\t\t\t></Pagination>\r\n\t\t\t\t\t</Card.Body>\r\n\t\t\t\t\t<ToastContainer></ToastContainer>\r\n\t\t\t\t</Card>\r\n\t\t\t</Container>\r\n\t\t</AuthGuard>\r\n\t);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}